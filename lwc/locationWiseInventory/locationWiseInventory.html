<template>
    <article class="slds-card">
        <div class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <div class="slds-media__figure">
                <span class="slds-icon_container slds-icon-standard-account" title="account">
                    <lightning-icon icon-name="custom:custom50" size="medium" alternative-text="warehouse"></lightning-icon>
                    <span class="slds-assistive-text">Warehouses</span>
                </span>
                </div>
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title">
                        <a class="slds-card__header-link slds-truncate" title="Warehouses">
                        <span>Warehouses</span>
                        </a>
                    </h2>
                </div>
            </header>
        </div>
        <div class="slds-card__body slds-card__body_inner" style="margin-top: .15rem;">
            <table if:true={hasWarehouses} class="slds-table slds-table_cell-buffer slds-table_bordered" style="border-bottom: 0;border-top: 0px;">
                <thead class="slds-hide">
                    <tr class="slds-line-height_reset">
                        <th class="slds-table_header" scope="col" style="width:2.25rem">
                        </th>
                        
                        <th class="slds-table_header" scope="col">
                            <div class="slds-truncate" title="Account Name">Warehouse Name</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={warehouses} for:item="warehouse">
                        <tr key={warehouse.warehouseId}>
                            <td class="slds-cell-edit slds-action-column_width" role="gridcell">
                                <button class={warehouse.drawerButtonClass} style="margin-left: .5rem;" title="Toggle Account Drawer" aria-expanded="true" data-id={warehouse.warehouseId} data-level="warehouse" onclick={openDrawer}>
                                    <lightning-icon icon-name="utility:chevronright" alternative-text="Doc image" size="xx-small"></lightning-icon>
                                </button>
                            </td>
                            <td class="slds-cell-edit" role="gridcell">
                                <div class="slds-form-element">
                                    <div class="slds-form-element__control">
                                        <div class="slds-checkbox">
                                            {warehouse.warehouseName}
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr if:true={warehouse.isDrawerOpen} key={warehouse.warehouseId} class="no-data-row slds-no-row-hover" style="height:3rem;">
                            <!--<td class="slds-cell-edit no-data-row slds-no-row-hover"></td>
                            <td class="slds-cell-edit no-data-row slds-no-row-hover" role="gridcell" colspan="6" style="padding-right:0rem;">
                                <table if:true={warehouse.hasLocations} class="slds-table slds-table_cell-buffer slds-table_bordered" style="border-left: 1px solid rgb(221, 219, 218);">
                                    <thead>
                                        <tr class="slds-line-height_reset">
                                            <th class="slds-table_header" scope="col" style="width:2.25rem">
                                            </th>
                                            <th class="slds-table_header" scope="col">
                                                <div class="slds-truncate" title="Location">Location</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tr if:true={warehouse.isDrawerOpen} key={warehouse.warehouseId} class="no-data-row slds-no-row-hover" style="height:3rem;">
                            <td class="slds-cell-edit no-data-row slds-no-row-hover"></td>
                            <td class="slds-cell-edit no-data-row slds-no-row-hover" role="gridcell" colspan="6" style="padding-right:0rem;">
                                <table if:true={warehouse.hasProducts} class="slds-table slds-table_cell-buffer slds-table_bordered" style="border-left: 1px solid rgb(221, 219, 218);">
                                    <thead>
                                        <tr class="slds-line-height_reset">
                                            <th class="slds-table_header" scope="col" style="width:2.25rem">
                                            </th>
                                            <th class="slds-table_header" scope="col">
                                                <div class="slds-truncate" title="Product">Product</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody if:true={warehouse.locations}>
                                            <template for:each={warehouse.locations} for:item="location">
                                                
                                                <tr key={location.locationId}>
                                                    <td class="slds-cell-edit" role="gridcell">
                                                        <button class={location.drawerButtonClass} title="Toggle Account Drawer" aria-expanded="true" data-id={location.locationId} data-level="location" onclick={openDrawer}>
                                                            <lightning-icon icon-name="utility:chevronright" alternative-text="Doc image" size="xx-small"></lightning-icon>
                                                        </button>
                                                    </td>
                                                    <td>
                                                        <div class="slds-truncate" title={location.locationName}>
                                                            {location.locationName}
                                                        </div>
                                                    </td>
                                                </tr>-->
                                    <!--<tbody if:true={warehouse.products}>
                                            <template for:each={warehouse.products} for:item="product">
                                                
                                                <tr key={product.productId}>
                                                    <td class="slds-cell-edit" role="gridcell">
                                                        <button class={product.drawerButtonClass} title="Toggle Account Drawer" aria-expanded="true" data-id={product.productId} data-level="product" onclick={openDrawer}>
                                                            <lightning-icon icon-name="utility:chevronright" alternative-text="Doc image" size="xx-small"></lightning-icon>
                                                        </button>
                                                    </td>
                                                    <td>
                                                        <div class="slds-truncate" title={product.productName}>
                                                            {product.productName}
                                                        </div>
                                                    </td>
                                                </tr>-->
                                                
                                                
                                                <!--<tr if:true={location.isDrawerOpen} key={location.locationId} class="no-data-row slds-no-row-hover" style="height:3rem;">
                                                    <tr if:true={product.isDrawerOpen} key={product.productId} class="no-data-row slds-no-row-hover" style="height:3rem;">-->
                                                    <td class="slds-cell-edit no-data-row slds-no-row-hover" role="gridcell" colspan="6" style="padding-right:0rem;padding-left:2rem !important;">
                                                        <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_fixed-layout inner_table" style="border-left: 1px solid rgb(221, 219, 218);">
                                                            <thead>
                                                                <tr class="slds-line-height_reset">                                                                    
                                                                    <th class="slds-table_header" scope="col">
                                                                        <div class="slds-truncate" title="Product Name">Product Name</div>
                                                                    </th>
                                                                    <th class="slds-table_header" scope="col">
                                                                        <div class="slds-truncate" title="Available Quantity">Available Quantity</div>
                                                                    </th>
                                                                    <th class="slds-table_header" scope="col">
                                                                        <div class="slds-truncate" title="Allocation Waiting Quantity">Allocation Waiting Quantity</div>
                                                                    </th>
                                                                    <th class="slds-table_header" scope="col">
                                                                        <div class="slds-truncate" title="Axle Position">Axle Position</div>
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <template if:true={warehouse.productLevelInventory}>
                                                                    <template for:each={warehouse.productLevelInventory} for:item="inventory">
                                                                <!--<template if:true={product.productLevelInventory}>
                                                                    <template for:each={product.productLevelInventory} for:item="inventory">-->
                                                                        <tr key={inventory.productId} if:true={inventory.selected} style={style}>
                                                                            
                                                                            <td class="slds-truncate" title={inventory.productName}>
                                                                                {inventory.productName}
                                                                            </td>
                                                                            <td>
                                                                                <div class="slds-truncate" title={inventory.availableQuantity}>
                                                                                    {inventory.availableQuantity}
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <div class="slds-truncate" title={inventory.allocationWaitingQuantity}>
                                                                                    {inventory.allocationWaitingQuantity}
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <div class="slds-truncate" title={inventory.axlePosition}>
                                                                                    {inventory.axlePosition}
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <tr key={inventory.productId} if:false={inventory.selected}>
                                                                            
                                                                            <td class="slds-truncate" title={inventory.productName}>
                                                                                {inventory.productName}
                                                                            </td>
                                                                            <td>
                                                                                <div class="slds-truncate" title={inventory.availableQuantity}>
                                                                                    {inventory.availableQuantity}
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <div class="slds-truncate" title={inventory.allocationWaitingQuantity}>
                                                                                    {inventory.allocationWaitingQuantity}
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <div class="slds-truncate" title={inventory.axlePosition}>
                                                                                    {inventory.axlePosition}
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                    </template>
                                                                </template>
                                                            </tbody>
                                                        </table> 
                                                    </td>
                                                <!--</tr>
                                                
                                            </template>
                                    </tbody>
                                </table>

                                <div if:false={warehouse.hasLocations} class="slds-notify slds-notify_alert slds-alert_offline slds-m-top_medium slds-m-bottom_medium" role="alert">
                                    <span class="slds-icon_container slds-icon-utility-offline slds-m-right_x-small" title="Description of icon when needed">
                                        <lightning-icon icon-name="utility:warning" alternative-text="warning" size="small" variant="inverse"></lightning-icon>
                                    </span>
                                    <h2>No locations available for this warehouse.</h2>
                                </div>
                            </td>-->
                        </tr>
                    </template>
                </tbody>
            </table>
            <!--<div if:false={warehouse.hasProducts} class="slds-notify slds-notify_alert slds-alert_offline slds-m-top_medium slds-m-bottom_medium" role="alert">
                                    <span class="slds-icon_container slds-icon-utility-offline slds-m-right_x-small" title="Description of icon when needed">
                                        <lightning-icon icon-name="utility:warning" alternative-text="warning" size="small" variant="inverse"></lightning-icon>
                                    </span>
                                    <h2>No products available for this warehouse.</h2>
                                </div>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>-->

            <div if:false={hasWarehouses} class="slds-notify slds-notify_alert slds-alert_offline slds-m-top_large slds-m-bottom_large" role="alert" >
                <span class="slds-icon_container slds-icon-utility-offline slds-m-right_x-small" title="Description of icon when needed">
                    <lightning-icon icon-name="utility:warning" alternative-text="warning" size="small" variant="inverse"></lightning-icon>
                </span>
                <h2>No relevant warehouse found.</h2>
            </div>
        </div>
    </article>
</template>